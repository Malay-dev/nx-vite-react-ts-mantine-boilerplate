{
  "version": 3,
  "sources": ["../../../../node_modules/@apollo/src/link/context/index.ts"],
  "sourcesContent": ["import { ApolloLink, Operation, GraphQLRequest, NextLink } from '../core';\nimport { Observable, ObservableSubscription } from '../../utilities';\n\nexport type ContextSetter = (\n  operation: GraphQLRequest,\n  prevContext: any,\n) => Promise<any> | any;\n\nexport function setContext(setter: ContextSetter): ApolloLink {\n  return new ApolloLink((operation: Operation, forward: NextLink) => {\n    const { ...request } = operation;\n\n    return new Observable(observer => {\n      let handle: ObservableSubscription;\n      let closed = false;\n      Promise.resolve(request)\n        .then(req => setter(req, operation.getContext()))\n        .then(operation.setContext)\n        .then(() => {\n          // if the observer is already closed, no need to subscribe.\n          if (closed) return;\n          handle = forward(operation).subscribe({\n            next: observer.next.bind(observer),\n            error: observer.error.bind(observer),\n            complete: observer.complete.bind(observer),\n          });\n        })\n        .catch(observer.error.bind(observer));\n\n      return () => {\n        closed = true;\n        if (handle) handle.unsubscribe();\n      };\n    });\n  });\n}\n"],
  "mappings": ";;;;;;;;AAQM,oBAAqB,QAAqB;AAC9C,SAAO,IAAI,WAAW,SAAC,WAAsB,SAAiB;AAC5D,QAAW,UAAO,OAAK,WAAjB;AAEN,WAAO,IAAI,WAAW,SAAA,UAAQ;AAC5B,UAAI;AACJ,UAAI,SAAS;AACb,cAAQ,QAAQ,SACb,KAAK,SAAA,KAAG;AAAI,eAAA,OAAO,KAAK,UAAU;SAClC,KAAK,UAAU,YACf,KAAK,WAAA;AAEJ,YAAI;AAAQ;AACZ,iBAAS,QAAQ,WAAW,UAAU;UACpC,MAAM,SAAS,KAAK,KAAK;UACzB,OAAO,SAAS,MAAM,KAAK;UAC3B,UAAU,SAAS,SAAS,KAAK;;SAGpC,MAAM,SAAS,MAAM,KAAK;AAE7B,aAAO,WAAA;AACL,iBAAS;AACT,YAAI;AAAQ,iBAAO;;;;;",
  "names": []
}
